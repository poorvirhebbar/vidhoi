# CUDA_VISIBLE_DEVICES=1,2 python tools/run_net_vidor.py --cfg configs/vidor/SLOWFAST_32x2_R50_SHORT_SCRATCH_EVAL_GT_trajectory-toipool.yaml DATA.PATH_TO_DATA_DIR slowfast/datasets/vidor NUM_GPUS 1 DATA_LOADER.NUM_WORKERS 0 TRAIN.BATCH_SIZE 16 TEST.BATCH_SIZE 2 LOG_MODEL_INFO False TRAIN.ENABLE True TRAIN.CHECKPOINT_FILE_PATH ./checkpoints/SLOWFAST_32x2_R50_SHORT_SCRATCH_EVAL_GT_trajectory-toipool/checkpoint_epoch_00020.pyth TRAIN.CHECKPOINT_TYPE pytorch VIDOR.TEST_DEBUG False TRAIN.AUTO_RESUME False


#CUDA_VISIBLE_DEVICES=2 python tools/run_net_vidor.py --cfg configs/vidor/VANILLA_TRAIN_RESNEXT101_FEAT.yaml DATA.PATH_TO_DATA_DIR slowfast/datasets/vidor NUM_GPUS 1 DATA_LOADER.NUM_WORKERS 1 TRAIN.BATCH_SIZE 2 TEST.BATCH_SIZE 1 LOG_MODEL_INFO False TRAIN.ENABLE True VIDOR.TEST_DEBUG False TRAIN.AUTO_RESUME True DATA_LOADER.PIN_MEMORY False MODEL.USE_LABEL_WEIGHTS True MODEL.DROPOUT 0.0 MODEL.USE_UNION_BBOX True OUTPUT_DIR ./output/VANILLA_RESNEXT_LABEL_WEIGHTS_UNION_FEAT_TEMP

#CUDA_VISIBLE_DEVICES=1 python tools/run_net_vidor.py --cfg configs/vidor/VANILLA_TRAIN_RESNEXT101_FEAT.yaml DATA.PATH_TO_DATA_DIR slowfast/datasets/vidor NUM_GPUS 1 DATA_LOADER.NUM_WORKERS 0 TRAIN.BATCH_SIZE 8 TEST.BATCH_SIZE 1 LOG_MODEL_INFO False TRAIN.ENABLE True VIDOR.TEST_DEBUG False TRAIN.AUTO_RESUME False DATA_LOADER.PIN_MEMORY False MODEL.USE_LABEL_WEIGHTS True MODEL.DROPOUT 0.0 MODEL.USE_UNION_BBOX True MODEL.USE_3D_CONV True OUTPUT_DIR ./output/VANILLA_3D_CONV_RESNEXT_LABEL_WEIGHTS_ALL_UNION_FEAT MODEL.INC_WEIGHTS True

#focal loss
#CUDA_VISIBLE_DEVICES=1 python tools/run_net_vidor.py --cfg configs/vidor/VANILLA_TRAIN_RESNEXT101_FEAT.yaml DATA.PATH_TO_DATA_DIR slowfast/datasets/vidor NUM_GPUS 1 DATA_LOADER.NUM_WORKERS 0 TRAIN.BATCH_SIZE 8 TEST.BATCH_SIZE 1 LOG_MODEL_INFO False TRAIN.ENABLE True VIDOR.TEST_DEBUG False TRAIN.AUTO_RESUME True DATA_LOADER.PIN_MEMORY False MODEL.DROPOUT 0.0 MODEL.USE_UNION_BBOX True MODEL.USE_3D_CONV True OUTPUT_DIR ./output/VANILLA_3D_CONV_RESNEXT_DROPOUT_UNION_FEAT_FOCAL_LOSS MODEL.USE_FOCAL_LOSS True MODEL.USE_LABEL_WEIGHTS True SOLVER.MAX_EPOCH 15

#weighted BCE LOSS + 3D CONV + AVG_FEAT
#CUDA_VISIBLE_DEVICES=2 python tools/run_net_vidor.py --cfg configs/vidor/VANILLA_TRAIN_RESNEXT101_FEAT.yaml DATA.PATH_TO_DATA_DIR slowfast/datasets/vidor NUM_GPUS 1 DATA_LOADER.NUM_WORKERS 0 TRAIN.BATCH_SIZE 8 TEST.BATCH_SIZE 1 LOG_MODEL_INFO False TRAIN.ENABLE True VIDOR.TEST_DEBUG False TRAIN.AUTO_RESUME True DATA_LOADER.PIN_MEMORY False MODEL.DROPOUT 0.0 MODEL.USE_UNION_BBOX True MODEL.USE_3D_CONV True OUTPUT_DIR ./output/VANILLA_3D_CONV_RESNEXT_UNION_FEAT_AVG_FEAT  MODEL.USE_LABEL_WEIGHTS True MODEL.AVG_FEAT True TEST.ENABLE False TRAIN.EVAL_PERIOD 15

#weighted BCE LOSS + 3D CONV + COORD_MASK
# CUDA_VISIBLE_DEVICES=2 python tools/run_net_vidor.py --cfg configs/vidor/VANILLA_TRAIN_RESNEXT101_FEAT.yaml DATA.PATH_TO_DATA_DIR slowfast/datasets/vidor NUM_GPUS 1 DATA_LOADER.NUM_WORKERS 0 TRAIN.BATCH_SIZE 8 TEST.BATCH_SIZE 1 LOG_MODEL_INFO False TRAIN.ENABLE True VIDOR.TEST_DEBUG False TRAIN.AUTO_RESUME True DATA_LOADER.PIN_MEMORY False MODEL.DROPOUT 0.0 MODEL.USE_UNION_BBOX True MODEL.USE_3D_CONV True OUTPUT_DIR ./output/VANILLA_3D_CONV_RESNEXT_UNION_FEAT_COORD_MASK_POSE MODEL.USE_LABEL_WEIGHTS True TRAIN.EVAL_PERIOD 15 MODEL.USE_COORD_MASK True MODEL.USE_ALPHA_POSES True


# Propensity + vanilla
# CUDA_VISIBLE_DEVICES=2 python tools/run_net_vidor.py --cfg configs/vidor/VANILLA_TRAIN_RESNEXT101_FEAT.yaml DATA.PATH_TO_DATA_DIR slowfast/datasets/vidor NUM_GPUS 1 DATA_LOADER.NUM_WORKERS 0 TRAIN.BATCH_SIZE 8 TEST.BATCH_SIZE 1 LOG_MODEL_INFO False TRAIN.ENABLE True VIDOR.TEST_DEBUG False TRAIN.AUTO_RESUME True DATA_LOADER.PIN_MEMORY False MODEL.DROPOUT 0.0 MODEL.USE_UNION_BBOX True MODEL.USE_3D_CONV True OUTPUT_DIR ./output/VANILLA_3D_CONV_RESNEXT_UNION_FEAT_PROPENSITY MODEL.USE_PROPENSITY True # MODEL.USE_LABEL_WEIGHTS True TRAIN.EVAL_PERIOD 2 # MODEL.USE_COORD_MASK True MODEL.USE_ALPHA_POSES True

# vanilla + BCE w/o weights
# CUDA_VISIBLE_DEVICES=2 python tools/run_net_vidor.py --cfg configs/vidor/VANILLA_TRAIN_RESNEXT101_FEAT.yaml DATA.PATH_TO_DATA_DIR slowfast/datasets/vidor NUM_GPUS 1 DATA_LOADER.NUM_WORKERS 0 TRAIN.BATCH_SIZE 8 TEST.BATCH_SIZE 1 LOG_MODEL_INFO False TRAIN.ENABLE True VIDOR.TEST_DEBUG False TRAIN.AUTO_RESUME True DATA_LOADER.PIN_MEMORY False MODEL.DROPOUT 0.0 MODEL.USE_UNION_BBOX True MODEL.USE_3D_CONV True OUTPUT_DIR ./output/VANILLA_3D_CONV_RESNEXT_UNION_FEAT # MODEL.USE_LABEL_WEIGHTS True TRAIN.EVAL_PERIOD 2 # MODEL.USE_COORD_MASK True MODEL.USE_ALPHA_POSES True

# weighted BCE LOSS + 3D CONV + POSES
CUDA_VISIBLE_DEVICES=2 python tools/run_net_vidor.py --cfg configs/vidor/VANILLA_TRAIN_RESNEXT101_FEAT.yaml DATA.PATH_TO_DATA_DIR slowfast/datasets/vidor NUM_GPUS 1 DATA_LOADER.NUM_WORKERS 0 TRAIN.BATCH_SIZE 8 TEST.BATCH_SIZE 1 LOG_MODEL_INFO False TRAIN.ENABLE True VIDOR.TEST_DEBUG False TRAIN.AUTO_RESUME True DATA_LOADER.PIN_MEMORY False MODEL.DROPOUT 0.0 MODEL.USE_UNION_BBOX True MODEL.USE_3D_CONV True MODEL.USE_LABEL_WEIGHTS True MODEL.USE_ALPHA_POSES True OUTPUT_DIR ./output/VANILLA_3D_CONV_RESNEXT_UNION_FEAT_POSE
